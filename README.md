# ğŸ¤– AIDefectDetector

<div align="center">

![Python Version](https://img.shields.io/badge/python-3.8%2B-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Platform](https://img.shields.io/badge/platform-Linux%20%7C%20macOS%20%7C%20Windows-lightgrey.svg)
![Architecture](https://img.shields.io/badge/architecture-AI%20Agent-orange.svg)

**åŸºäºAI Agentçš„æ™ºèƒ½ä»£ç ç¼ºé™·æ£€æµ‹ä¸ä¿®å¤ç³»ç»Ÿ**

[ğŸš€ å¿«é€Ÿå¼€å§‹](docs/QUICKSTART.md) â€¢ [ğŸ“– å®‰è£…æŒ‡å—](docs/Guide/INSTALL_GUIDE.md) â€¢ [ğŸ”‘ APIé…ç½®](docs/Guide/API_CONFIG_GUIDE.md)

</div>

---

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

AIDefectDetectoræ˜¯ä¸€ä¸ªåŸºäºAI Agentæ¶æ„çš„æ™ºèƒ½åŒ–ä»£ç ç¼ºé™·æ£€æµ‹ä¸ä¿®å¤ç³»ç»Ÿï¼Œèƒ½å¤Ÿè‡ªä¸»ç†è§£é¡¹ç›®ä¸Šä¸‹æ–‡ã€åˆ©ç”¨å¤šç§åˆ†æå·¥å…·ã€åˆ¶å®šå†³ç­–å¹¶æ‰§è¡Œä¿®å¤ä»»åŠ¡ã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒå››ç§æ™ºèƒ½å·¥ä½œæ¨¡å¼å’Œå®Œæ•´çš„AIé©±åŠ¨ä¿®å¤å·¥ä½œæµã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

#### ğŸ¯ å››ç§æ™ºèƒ½å·¥ä½œæ¨¡å¼
- **ğŸ“Š é™æ€åˆ†ææ¨¡å¼** - åŸºäºä¼ ç»Ÿå·¥å…·çš„å¿«é€Ÿä»£ç æ£€æŸ¥ï¼ˆé›¶æˆæœ¬ï¼‰
- **ğŸ§  æ·±åº¦åˆ†ææ¨¡å¼** - AIæ™ºèƒ½ä»£ç åˆ†æå’Œæ·±åº¦æ´å¯Ÿ
- **ğŸ”§ ä¿®å¤åˆ†ææ¨¡å¼** - AIé©±åŠ¨çš„é—®é¢˜æ£€æµ‹å’Œè‡ªåŠ¨ä¿®å¤
- **ğŸ”„ å·¥ä½œæµä¿®å¤æ¨¡å¼** - å®Œæ•´çš„Bâ†’Câ†’Dâ†’Eâ†’F/Gâ†’Hâ†’Iâ†’J/Kâ†’Lâ†’B/M AIä¿®å¤å·¥ä½œæµ â­

#### ğŸ–¥ï¸ åŒç•Œé¢æ”¯æŒ
- **ğŸ’» CLIç•Œé¢** - é€‚åˆå¼€å‘è€…å’Œè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œæ”¯æŒäº¤äº’å¼å¯¹è¯
- **ğŸŒ Webç•Œé¢** - ç›´è§‚çš„å¯è§†åŒ–æ“ä½œç•Œé¢ï¼Œæ”¯æŒæ‹–æ‹½ä¸Šä¼ 

#### ğŸ› ï¸ ä¸°å¯Œçš„åˆ†æå·¥å…·
- **ASTè¯­æ³•åˆ†æå™¨** - æ·±åº¦è§£æä»£ç ç»“æ„
- **å¤šè¯­è¨€é™æ€åˆ†æ** - Pylintã€Flake8ã€Bandité›†æˆ
- **AIæ™ºèƒ½æ£€æµ‹** - åŸºäºå¤§æ¨¡å‹çš„æ·±åº¦é—®é¢˜å‘ç°
- **å®‰å…¨æ‰«æ** - å¸¸è§å®‰å…¨æ¼æ´æ£€æµ‹

#### ğŸ¯ æ™ºèƒ½åŒ–åŠŸèƒ½
- **ğŸ¤– AIé©±åŠ¨å†³ç­–** - æ™ºèƒ½æ–‡ä»¶é€‰æ‹©ã€é—®é¢˜åˆ†æã€ä¿®å¤å»ºè®®
- **ğŸ‘¥ ç”¨æˆ·åä½œæœºåˆ¶** - AIå»ºè®® + ç”¨æˆ·å†³ç­–çš„åé¦ˆå¾ªç¯
- **ğŸ”„ å®Œæ•´å·¥ä½œæµ** - ä»é—®é¢˜å‘ç°åˆ°ä¿®å¤éªŒè¯çš„é—­ç¯æµç¨‹
- **ğŸ“Š è¯¦ç»†è¿½è¸ª** - å®æ—¶æ˜¾ç¤ºåˆ†æè¿›åº¦å’Œè¯¦ç»†ç»“æœ

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„è®¾è®¡

```mermaid
graph TB
    subgraph "ç”¨æˆ·ç•Œé¢å±‚"
        CLI[CLIå‘½ä»¤è¡Œç•Œé¢]
        WEB[Webå¯è§†åŒ–ç•Œé¢]
    end

    subgraph "ç¼–æ’æ§åˆ¶å±‚"
        ORCHESTRATOR[Agentç¼–æ’å™¨]
        PLANNER[ä»»åŠ¡è§„åˆ’å™¨]
        EXECUTION[æ‰§è¡Œå¼•æ“]
        ROUTER[æ¨¡å¼è·¯ç”±å™¨]
    end

    subgraph "æ ¸å¿ƒåŠŸèƒ½å±‚"
        STATIC[é™æ€åˆ†ææ¨¡å—]
        DEEP[æ·±åº¦åˆ†ææ¨¡å—]
        FIX[ä¿®å¤åˆ†ææ¨¡å—]
        WORKFLOW[å·¥ä½œæµå¼•æ“]
    end

    subgraph "AIé›†æˆå±‚"
        LLM_CLIENT[LLMç»Ÿä¸€å®¢æˆ·ç«¯]
        PROVIDERS[å¤šæä¾›å•†æ”¯æŒ]
        PROMPTS[æç¤ºè¯ç®¡ç†]
    end

    subgraph "å·¥å…·é›†æˆå±‚"
        AST_ANALYZER[ASTåˆ†æå™¨]
        PYLINT[Pylintæ£€æŸ¥å™¨]
        FLAKE8[Flake8æ£€æŸ¥å™¨]
        BANDIT[å®‰å…¨æ‰«æå™¨]
        BACKUP[å¤‡ä»½ç®¡ç†å™¨]
    end

    subgraph "åŸºç¡€è®¾æ–½å±‚"
        CONFIG[é…ç½®ç®¡ç†]
        LOGGER[æ—¥å¿—ç³»ç»Ÿ]
        CACHE[ç¼“å­˜ç³»ç»Ÿ]
        UTILS[å·¥å…·ç±»åº“]
    end

    CLI --> ORCHESTRATOR
    WEB --> ORCHESTRATOR
    ORCHESTRATOR --> PLANNER
    ORCHESTRATOR --> ROUTER
    ROUTER --> STATIC
    ROUTER --> DEEP
    ROUTER --> FIX
    ROUTER --> WORKFLOW

    DEEP --> LLM_CLIENT
    FIX --> LLM_CLIENT
    WORKFLOW --> LLM_CLIENT

    LLM_CLIENT --> PROVIDERS
    LLM_CLIENT --> PROMPTS

    STATIC --> AST_ANALYZER
    STATIC --> PYLINT
    STATIC --> FLAKE8
    STATIC --> BANDIT

    FIX --> BACKUP
    WORKFLOW --> BACKUP
```

### æ ¸å¿ƒè®¾è®¡æ¨¡å¼

#### ğŸ­ Agentæ¶æ„æ¨¡å¼
- **ç¼–æ’å™¨æ¨¡å¼** - `AgentOrchestrator` ç»Ÿä¸€åè°ƒæ‰€æœ‰ç»„ä»¶
- **ç­–ç•¥æ¨¡å¼** - `ModeRouter` æ ¹æ®ç”¨æˆ·éœ€æ±‚é€‰æ‹©åˆ†æç­–ç•¥
- **å‘½ä»¤æ¨¡å¼** - å„åˆ†ææ¨¡å—å®ç°ç»Ÿä¸€çš„å‘½ä»¤æ¥å£
- **è§‚å¯Ÿè€…æ¨¡å¼** - ç”¨æˆ·äº¤äº’å¤„ç†å™¨ç›‘å¬ç”¨æˆ·å†³ç­–

#### ğŸ”„ å·¥ä½œæµçŠ¶æ€æœºæ¨¡å¼
- **çŠ¶æ€æ¨¡å¼** - `WorkflowFlowStateManager` ç®¡ç†å¤æ‚çš„çŠ¶æ€è½¬æ¢
- **è´£ä»»é“¾æ¨¡å¼** - å·¥ä½œæµå„èŠ‚ç‚¹æŒ‰é¡ºåºå¤„ç†
- **å¤‡å¿˜å½•æ¨¡å¼** - å·¥ä½œæµä¼šè¯çš„å¤‡ä»½å’Œæ¢å¤

#### ğŸ­ å·¥å‚æ¨¡å¼
- **æŠ½è±¡å·¥å‚** - `LLMProvider` åˆ›å»ºä¸åŒLLMæä¾›å•†å®ä¾‹
- **å»ºé€ è€…æ¨¡å¼** - æç¤ºè¯çš„æ„å»ºå’Œæ¸²æŸ“
- **å•ä¾‹æ¨¡å¼** - é…ç½®ç®¡ç†å™¨å’Œæ—¥å¿—ç³»ç»Ÿ

#### ğŸ¯ ç­–ç•¥æ¨¡å¼
- **å¤šæ€åˆ†æå™¨** - ä¸åŒç¼–ç¨‹è¯­è¨€çš„é™æ€åˆ†æç­–ç•¥
- **æ¸²æŸ“å™¨ç­–ç•¥** - ä¸åŒæ ¼å¼çš„æŠ¥å‘Šç”Ÿæˆ
- **éªŒè¯ç­–ç•¥** - ä¸åŒç±»å‹çš„ä¿®å¤éªŒè¯

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“¦ ä¸€é”®å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd AIDefectDetector

# è¿è¡Œå®‰è£…è„šæœ¬
bash scripts/install_unix.sh  # Linux/macOS
scripts\install_windows.bat   # Windows
```

### âš¡ 5åˆ†é’Ÿä½“éªŒ

```bash
# 1. é…ç½®APIå¯†é’¥ï¼ˆæ¨èæ™ºè°±AIï¼‰
python3 scripts/configure_llm.py --provider zhipu

# 2. é™æ€åˆ†æï¼ˆæ— éœ€APIå¯†é’¥ï¼‰
python3 main.py analyze static ./src

# 3. æ·±åº¦åˆ†æï¼ˆéœ€è¦APIå¯†é’¥ï¼‰
python3 main.py analyze deep ./src

# 4. å·¥ä½œæµä¿®å¤ï¼ˆæ¨èï¼‰
python3 main.py analyze workflow ./src

# 5. Webç•Œé¢
python3 main.py web
```

### ğŸ”§ ç°ä»£åŒ–æ„å»ºæ–¹å¼ (pyproject.toml)

é¡¹ç›®æ”¯æŒç°ä»£ Python é¡¹ç›®æ„å»ºæ ‡å‡†ï¼Œä½¿ç”¨ `pyproject.toml` é…ç½®æ–‡ä»¶ï¼š

```bash
# å®‰è£…æ„å»ºä¾èµ–
pip install build

# æ„å»ºåˆ†å‘åŒ…
python -m build

# ç”Ÿæˆçš„åŒ…ä½äº dist/ ç›®å½•ï¼š
# - aidefect-1.0.0-py3-none-any.whl (wheelåŒ…)
# - aidefect-1.0.0.tar.gz (æºç åŒ…)

# å®‰è£…æ„å»ºçš„åŒ…
pip install dist/aidefect-1.0.0-py3-none-any.whl

# å¼€å‘æ¨¡å¼å®‰è£…
pip install -e .

# å®‰è£…ç‰¹å®šåŠŸèƒ½ç»„åˆ
pip install -e .[dev]          # å¼€å‘å·¥å…·
pip install -e .[web]          # Webç•Œé¢å¢å¼º
pip install -e .[all]          # å®Œæ•´åŠŸèƒ½
```

## ğŸ“Š ä½¿ç”¨ç¤ºä¾‹

### é™æ€åˆ†ææ¨¡å¼
```bash
# åˆ†ææ•´ä¸ªé¡¹ç›®
python3 main.py analyze static /path/to/project

# ä½¿ç”¨ç‰¹å®šå·¥å…·
python3 main.py analyze static ./src --tools pylint,bandit

# ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
python3 main.py analyze static ./src --format json --output report.json
```

### æ·±åº¦åˆ†ææ¨¡å¼
```bash
# äº¤äº’å¼æ·±åº¦åˆ†æ
python3 main.py analyze deep ./src --interactive

# æŒ‡å®šæ¨¡å‹
python3 main.py analyze deep ./src --model glm-4.5

# è¯¦ç»†è¾“å‡º
python3 main.py analyze deep ./src/utils/config.py --verbose
```

### å·¥ä½œæµä¿®å¤æ¨¡å¼ â­
```bash
# å¯åŠ¨å®Œæ•´å·¥ä½œæµ
python3 main.py analyze workflow ./src

# è¯¦ç»†æµç¨‹è¿½è¸ª
python3 main.py analyze workflow ./src --verbose

# æ¨¡æ‹Ÿè¿è¡Œ
python3 main.py analyze workflow ./src --dry-run

# å¯¼å‡ºç»“æœ
python3 main.py analyze workflow ./src --output workflow_results.json
```

## ğŸ”„ å·¥ä½œæµæ¨¡å¼è¯¦è§£

å·¥ä½œæµæ¨¡å¼æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå®ç°äº†å®Œæ•´çš„AIé©±åŠ¨ä¿®å¤é—­ç¯ï¼š

```mermaid
graph TD
    A[Phase Aå®Œæˆ<br/>æ–‡ä»¶é€‰æ‹©] --> B[èŠ‚ç‚¹B<br/>AIé—®é¢˜æ£€æµ‹]
    B --> C[èŠ‚ç‚¹C<br/>ä¿®å¤å»ºè®®ç”Ÿæˆ]
    C --> D[èŠ‚ç‚¹D<br/>ç”¨æˆ·å®¡æŸ¥]
    D --> E{èŠ‚ç‚¹E<br/>ç”¨æˆ·å†³ç­–}
    E -->|æ‰¹å‡†| F[èŠ‚ç‚¹F<br/>æ‰§è¡Œè‡ªåŠ¨ä¿®å¤]
    E -->|ä¿®æ”¹| C
    E -->|æ‹’ç»| G[èŠ‚ç‚¹G<br/>è·³è¿‡é—®é¢˜]
    F --> H[èŠ‚ç‚¹H<br/>ä¿®å¤éªŒè¯]
    G --> L
    H --> I{èŠ‚ç‚¹I<br/>ç”¨æˆ·éªŒè¯å†³ç­–}
    I -->|æ¥å—| J[èŠ‚ç‚¹J<br/>é—®é¢˜è§£å†³]
    I -->|æ‹’ç»| K[èŠ‚ç‚¹K<br/>é‡æ–°åˆ†æ]
    K --> B
    J --> L{èŠ‚ç‚¹L<br/>æ£€æŸ¥å‰©ä½™é—®é¢˜}
    L -->|æœ‰é—®é¢˜| B
    L -->|æ— é—®é¢˜| M[èŠ‚ç‚¹M<br/>å·¥ä½œæµå®Œæˆ]
```

### å·¥ä½œæµç‰¹ç‚¹
- ğŸ¤– **AIé©±åŠ¨** - é—®é¢˜æ£€æµ‹å’Œä¿®å¤å»ºè®®å®Œå…¨ç”±AIå®Œæˆ
- ğŸ‘¥ **ç”¨æˆ·åä½œ** - å…³é”®å†³ç­–ç‚¹éœ€è¦ç”¨æˆ·ç¡®è®¤å’Œå»ºè®®
- ğŸ”„ **é—­ç¯æµç¨‹** - ä»é—®é¢˜å‘ç°åˆ°ä¿®å¤éªŒè¯çš„å®Œæ•´é—­ç¯
- ğŸ›¡ï¸ **å®‰å…¨ä¿æŠ¤** - è‡ªåŠ¨å¤‡ä»½å’Œå›æ»šæœºåˆ¶
- ğŸ“Š **æµç¨‹è¿½è¸ª** - è¯¦ç»†è®°å½•æ¯ä¸ªæ­¥éª¤çš„æ‰§è¡Œæƒ…å†µ

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **Python 3.8+** - ä¸»è¦å¼€å‘è¯­è¨€
- **Flask** - Webç•Œé¢æ¡†æ¶
- **Loguru** - ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ
- **PyYAML** - é…ç½®æ–‡ä»¶ç®¡ç†

### AIé›†æˆ
- **æ™ºè°±AI SDK** - GLM-4ç³»åˆ—æ¨¡å‹
- **OpenAI API** - GPTç³»åˆ—æ¨¡å‹
- **Anthropic API** - Claudeç³»åˆ—æ¨¡å‹

### é™æ€åˆ†æå·¥å…·
- **AST** - Pythonè¯­æ³•æ ‘åˆ†æ
- **Pylint** - ä»£ç è´¨é‡æ£€æŸ¥
- **Flake8** - ä»£ç é£æ ¼æ£€æŸ¥
- **Bandit** - å®‰å…¨æ¼æ´æ£€æµ‹

### å¼€å‘å·¥å…·
- **pytest** - æµ‹è¯•æ¡†æ¶
- **black** - ä»£ç æ ¼å¼åŒ–
- **mypy** - ç±»å‹æ£€æŸ¥
- **isort** - å¯¼å…¥æ’åº

## ğŸ“ é¡¹ç›®ç»“æ„

```
AIDefectDetector/
â”œâ”€â”€ ğŸ“„ main.py                      # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ ğŸ“ src/                         # æ ¸å¿ƒæºä»£ç 
â”‚   â”œâ”€â”€ ğŸ¤– agent/                    # Agentæ ¸å¿ƒé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ orchestrator.py         # ç¼–æ’å™¨ - æ ¸å¿ƒåè°ƒå™¨
â”‚   â”‚   â”œâ”€â”€ planner.py               # ä»»åŠ¡è§„åˆ’å™¨
â”‚   â”‚   â”œâ”€â”€ execution_engine.py      # æ‰§è¡Œå¼•æ“
â”‚   â”‚   â”œâ”€â”€ mode_router.py           # æ¨¡å¼è·¯ç”±å™¨
â”‚   â”‚   â”œâ”€â”€ file_selector.py         # æ™ºèƒ½æ–‡ä»¶é€‰æ‹©å™¨
â”‚   â”‚   â””â”€â”€ user_interaction.py     # ç”¨æˆ·äº¤äº’å¤„ç†å™¨
â”‚   â”œâ”€â”€ ğŸ–¥ï¸ interfaces/               # æ¥å£å±‚
â”‚   â”‚   â”œâ”€â”€ cli.py                   # CLIå‘½ä»¤è¡Œç•Œé¢
â”‚   â”‚   â”œâ”€â”€ web.py                   # Webå¯è§†åŒ–ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ workflow_commands.py     # å·¥ä½œæµå‘½ä»¤å¤„ç†
â”‚   â”‚   â”œâ”€â”€ static_commands.py       # é™æ€åˆ†æå‘½ä»¤
â”‚   â”‚   â”œâ”€â”€ deep_commands.py         # æ·±åº¦åˆ†æå‘½ä»¤
â”‚   â”‚   â””â”€â”€ fix_commands.py          # ä¿®å¤åˆ†æå‘½ä»¤
â”‚   â”œâ”€â”€ ğŸ§  llm/                       # LLMé›†æˆæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ client.py                # ç»Ÿä¸€LLMå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ config.py                # LLMé…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ zhipu_provider.py        # æ™ºè°±AIæä¾›å•†
â”‚   â”‚   â”œâ”€â”€ openai_provider.py       # OpenAIæä¾›å•†
â”‚   â”‚   â”œâ”€â”€ anthropic_provider.py    # Anthropicæä¾›å•†
â”‚   â”‚   â””â”€â”€ mock_provider.py         # Mockæµ‹è¯•æä¾›å•†
â”‚   â”œâ”€â”€ ğŸ› ï¸ tools/                     # å·¥å…·é›†æˆæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ workflow_flow_state_manager.py  # å·¥ä½œæµçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ multilang_static_analyzer.py   # å¤šè¯­è¨€é™æ€åˆ†æ
â”‚   â”‚   â”œâ”€â”€ ai_problem_detector.py           # AIé—®é¢˜æ£€æµ‹å™¨
â”‚   â”‚   â”œâ”€â”€ ai_fix_suggestion_generator.py   # AIä¿®å¤å»ºè®®ç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€â”€ verification_static_analyzer.py  # ä¿®å¤éªŒè¯åˆ†æå™¨
â”‚   â”‚   â”œâ”€â”€ backup_manager.py               # å¤‡ä»½ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ ast_analyzer.py                 # ASTè¯­æ³•åˆ†æå™¨
â”‚   â”‚   â”œâ”€â”€ pylint_analyzer.py              # Pylintåˆ†æå™¨
â”‚   â”‚   â”œâ”€â”€ flake8_analyzer.py              # Flake8åˆ†æå™¨
â”‚   â”‚   â””â”€â”€ bandit_analyzer.py              # Banditå®‰å…¨åˆ†æå™¨
â”‚   â”œâ”€â”€ ğŸ’¡ prompts/                   # æç¤ºè¯ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ manager.py               # æç¤ºè¯ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ templates.py             # æç¤ºè¯æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ renderer.py              # æç¤ºè¯æ¸²æŸ“å™¨
â”‚   â””â”€â”€ ğŸ”§ utils/                     # å·¥å…·ç±»åº“
â”‚       â”œâ”€â”€ config.py                # é…ç½®ç®¡ç†å™¨
â”‚       â”œâ”€â”€ logger.py                # æ—¥å¿—ç³»ç»Ÿ
â”‚       â”œâ”€â”€ cache.py                 # ç¼“å­˜ç®¡ç†
â”‚       â””â”€â”€ path_resolver.py         # è·¯å¾„è§£æå™¨
â”œâ”€â”€ ğŸ“ config/                        # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ llm_config.yaml             # LLMæä¾›å•†é…ç½®
â”‚   â”œâ”€â”€ project_analysis_config.yaml # é¡¹ç›®åˆ†æé…ç½®
â”‚   â””â”€â”€ examples/                    # é…ç½®æ¨¡æ¿
â”œâ”€â”€ ğŸ“ scripts/                       # ç®¡ç†è„šæœ¬ â­
â”‚   â”œâ”€â”€ install_unix.sh             # Unix/Linux/macOSå®‰è£…è„šæœ¬
â”‚   â”œâ”€â”€ install_windows.bat         # Windowså®‰è£…è„šæœ¬
â”‚   â””â”€â”€ configure_llm.py            # LLMé…ç½®ç»Ÿä¸€è„šæœ¬
â”œâ”€â”€ ğŸ“ docs/                          # æ–‡æ¡£ ğŸ“š
â”‚   â”œâ”€â”€ QUICKSTART.md               # ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—
â”‚   â””â”€â”€ Guide/                      # è¯¦ç»†æŒ‡å—
â”‚       â”œâ”€â”€ INSTALL_GUIDE.md         # ğŸ“¦ å®‰è£…æŒ‡å—
â”‚       â””â”€â”€ API_CONFIG_GUIDE.md      # ğŸ”‘ APIé…ç½®æŒ‡å—
â”œâ”€â”€ ğŸ“ example/                       # ç¤ºä¾‹é¡¹ç›®
â”œâ”€â”€ ğŸ“ tests/                         # æµ‹è¯•å¥—ä»¶
â”œâ”€â”€ ğŸ“ .fix_backups/                 # ä¿®å¤å¤‡ä»½ç³»ç»Ÿ
â””â”€â”€ ğŸ“ .workflow_sessions/            # å·¥ä½œæµä¼šè¯è®°å½•
```

## ğŸ§ª ç±»å›¾

```mermaid
classDiagram
    class AgentOrchestrator {
        -sessions: Dict[str, Session]
        -current_session: Optional[Session]
        +create_session(user_id: str): Session
        +process_request(request: str): ExecutionResult
        +get_session_history(session_id: str): List[ChatMessage]
    }

    class TaskPlanner {
        +plan_request(user_input: str): ExecutionPlan
        +analyze_mode(input: str): AnalysisMode
        +extract_target(input: str): str
    }

    class ExecutionEngine {
        +execute_plan(plan: ExecutionPlan): ExecutionResult
        +handle_static_analysis(target: str): Result
        +handle_deep_analysis(target: str): Result
        +handle_fix_analysis(target: str): Result
        +handle_workflow(target: str): Result
    }

    class WorkflowFlowStateManager {
        -current_session: WorkflowSession
        +transition_to(node: WorkflowNode): bool
        +get_current_state(): WorkflowNode
        +can_transition_to(target_node: WorkflowNode): bool
        +add_transition(from_node, to_node, reason): WorkflowStateTransition
    }

    class LLMClient {
        -providers: Dict[str, LLMProvider]
        -config_manager: LLMConfigManager
        +complete(request, provider_name): LLMResponse
        +get_available_providers(): List[str]
        +test_provider(provider_name): bool
    }

    class LLMProvider {
        <<abstract>>
        +complete(request): LLMResponse
        +validate_config(): bool
        +get_model_info(): ModelInfo
    }

    class ZhipuProvider {
        -api_key: str
        -model: str
        +complete(request): LLMResponse
        +call_api(messages): Dict
    }

    class OpenAIProvider {
        -api_key: str
        -model: str
        +complete(request): LLMResponse
        +call_api(messages): Dict
    }

    class StaticAnalyzer {
        <<interface>>
        +analyze(file_path: str): AnalysisResult
        +get_supported_extensions(): List[str]
    }

    class ASTAnalyzer {
        +analyze(file_path: str): AnalysisResult
        +parse_ast(content): ast.AST
        +extract_issues(node): List[Issue]
    }

    class WorkflowSession {
        -session_id: str
        -current_node: WorkflowNode
        -workflow_history: List[WorkflowStateTransition]
        -problems_detected: List[AIDetectedProblem]
        +add_transition(from_node, to_node, reason): WorkflowStateTransition
        +get_next_problem(): Optional[AIDetectedProblem]
    }

    AgentOrchestrator --> TaskPlanner
    AgentOrchestrator --> ExecutionEngine
    ExecutionEngine --> WorkflowFlowStateManager
    ExecutionEngine --> LLMClient
    LLMClient --> LLMProvider
    LLMProvider <|-- ZhipuProvider
    LLMProvider <|-- OpenAIProvider
    ExecutionEngine --> StaticAnalyzer
    StaticAnalyzer <|-- ASTAnalyzer
    WorkflowFlowStateManager --> WorkflowSession
```

## ğŸ”„ ä¸»è¦æµç¨‹å›¾

### 1. æ•´ä½“åˆ†ææµç¨‹

```mermaid
flowchart TD
    A[ç”¨æˆ·è¾“å…¥] --> B{æ¨¡å¼è¯†åˆ«}
    B -->|static| C[é™æ€åˆ†ææµç¨‹]
    B -->|deep| D[æ·±åº¦åˆ†ææµç¨‹]
    B -->|fix| E[ä¿®å¤åˆ†ææµç¨‹]
    B -->|workflow| F[å·¥ä½œæµä¿®å¤æµç¨‹]

    C --> C1[å¤šå·¥å…·å¹¶è¡Œåˆ†æ]
    C1 --> C2[ç»“æœèšåˆ]
    C2 --> C3[ç”ŸæˆæŠ¥å‘Š]

    D --> D1[æ„å»ºåˆ†æä¸Šä¸‹æ–‡]
    D1 --> D2[AIæ¨¡å‹è°ƒç”¨]
    D2 --> D3[ç»“æœè§£æ]
    D3 --> D4[äº¤äº’å¼å¯¹è¯]

    E --> E1[é—®é¢˜æ£€æµ‹]
    E1 --> E2[ä¿®å¤å»ºè®®ç”Ÿæˆ]
    E2 --> E3[ç”¨æˆ·ç¡®è®¤]
    E3 --> E4[æ‰§è¡Œä¿®å¤]
    E4 --> E5[ä¿®å¤éªŒè¯]

    F --> F1[Phase A: æ–‡ä»¶é€‰æ‹©]
    F1 --> F2[Node B: AIé—®é¢˜æ£€æµ‹]
    F2 --> F3[Node C: ä¿®å¤å»ºè®®]
    F3 --> F4[Node D: ç”¨æˆ·å®¡æŸ¥]
    F4 --> F5[Node E: ç”¨æˆ·å†³ç­–]
    F5 --> F6{å†³ç­–åˆ†æ”¯}
    F6 -->|æ‰¹å‡†| F7[Node F: æ‰§è¡Œä¿®å¤]
    F6 -->|æ‹’ç»| F8[Node G: è·³è¿‡é—®é¢˜]
    F7 --> F9[Node H: ä¿®å¤éªŒè¯]
    F8 --> F12[Node L: æ£€æŸ¥å‰©ä½™]
    F9 --> F10[Node I: éªŒè¯å†³ç­–]
    F10 --> F11{éªŒè¯ç»“æœ}
    F11 -->|æˆåŠŸ| F13[Node J: é—®é¢˜è§£å†³]
    F11 -->|å¤±è´¥| F14[Node K: é‡æ–°åˆ†æ]
    F13 --> F12
    F14 --> F2
    F12 --> F15{æ˜¯å¦æœ‰é—®é¢˜}
    F15 -->|æ˜¯| F2
    F15 -->|å¦| F16[Node M: å·¥ä½œæµå®Œæˆ]

    C3 --> G[è¾“å‡ºç»“æœ]
    D4 --> G
    E5 --> G
    F16 --> G
```

### 2. å·¥ä½œæµçŠ¶æ€æœºæµç¨‹

```mermaid
stateDiagram-v2
    [*] --> PhaseAComplete

    PhaseAComplete --> ProblemDetection: å¼€å§‹æ£€æµ‹
    ProblemDetection --> FixSuggestion: ç”Ÿæˆå»ºè®®

    FixSuggestion --> UserReview: ç”¨æˆ·å®¡æŸ¥
    UserReview --> UserDecision: åšå‡ºå†³ç­–

    UserDecision --> AutoFix: æ‰¹å‡†ä¿®å¤
    UserDecision --> SkipProblem: æ‹’ç»ä¿®å¤
    UserDecision --> FixSuggestion: ä¿®æ”¹å»ºè®®

    AutoFix --> FixVerification: æ‰§è¡Œå®Œæˆ
    SkipProblem --> CheckRemaining: è·³è¿‡é—®é¢˜

    FixVerification --> VerificationDecision: éªŒè¯å®Œæˆ

    VerificationDecision --> ProblemSolved: éªŒè¯é€šè¿‡
    VerificationDecision --> Reanalysis: éªŒè¯å¤±è´¥

    ProblemSolved --> CheckRemaining: é—®é¢˜è§£å†³
    Reanalysis --> ProblemDetection: é‡æ–°åˆ†æ

    CheckRemaining --> ProblemDetection: æœ‰å‰©ä½™é—®é¢˜
    CheckRemaining --> WorkflowComplete: æ— å‰©ä½™é—®é¢˜

    WorkflowComplete --> [*]
```

### 3. AIäº¤äº’æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant CLI as CLIç•Œé¢
    participant ORC as Agentç¼–æ’å™¨
    participant PLANNER as ä»»åŠ¡è§„åˆ’å™¨
    participant ENGINE as æ‰§è¡Œå¼•æ“
    participant LLM as LLMå®¢æˆ·ç«¯
    participant AI as AIæ¨¡å‹

    U->>CLI: analyze deep ./src
    CLI->>ORC: å¤„ç†ç”¨æˆ·è¯·æ±‚
    ORC->>PLANNER: åˆ†æç”¨æˆ·è¾“å…¥
    PLANNER->>ORC: è¿”å›æ‰§è¡Œè®¡åˆ’
    ORC->>ENGINE: æ‰§è¡Œæ·±åº¦åˆ†æ

    ENGINE->>LLM: è°ƒç”¨AIåˆ†æ
    LLM->>AI: å‘é€è¯·æ±‚
    AI->>LLM: è¿”å›åˆ†æç»“æœ
    LLM->>ENGINE: è¿”å›ç»“æ„åŒ–ç»“æœ

    ENGINE->>ORC: è¿”å›æ‰§è¡Œç»“æœ
    ORC->>CLI: æ ¼å¼åŒ–è¾“å‡º
    CLI->>U: æ˜¾ç¤ºåˆ†æç»“æœ

    U->>CLI: è¿™ä¸ªå‡½æ•°æœ‰ä»€ä¹ˆé—®é¢˜?
    CLI->>ORC: å¤„ç†è¿½é—®
    ORC->>LLM: ä¸Šä¸‹æ–‡å¯¹è¯
    LLM->>AI: å‘é€ä¸Šä¸‹æ–‡
    AI->>LLM: è¿”å›è¯¦ç»†åˆ†æ
    LLM->>ORC: è¿”å›ç»“æœ
    ORC->>CLI: æ ¼å¼åŒ–è¾“å‡º
    CLI->>U: æ˜¾ç¤ºè¯¦ç»†åˆ†æ
```

## ğŸ¯ è®¾è®¡æ¨¡å¼è¯¦è§£

### 1. Agentæ¶æ„æ¨¡å¼
```python
class AgentOrchestrator:
    """ç¼–æ’å™¨æ¨¡å¼ - ç»Ÿä¸€åè°ƒæ‰€æœ‰ç»„ä»¶"""
    def __init__(self):
        self.planner = TaskPlanner()
        self.engine = ExecutionEngine()
        self.router = ModeRouter()

    def process_request(self, user_input: str):
        plan = self.planner.plan_request(user_input)
        return self.engine.execute_plan(plan)
```

### 2. ç­–ç•¥æ¨¡å¼
```python
class ModeRouter:
    """ç­–ç•¥æ¨¡å¼ - æ ¹æ®ç”¨æˆ·éœ€æ±‚é€‰æ‹©åˆ†æç­–ç•¥"""
    def __init__(self):
        self.strategies = {
            'static': StaticAnalysisStrategy(),
            'deep': DeepAnalysisStrategy(),
            'fix': FixAnalysisStrategy(),
            'workflow': WorkflowStrategy()
        }

    def route_request(self, request: RouteRequest) -> RouteResult:
        strategy = self.strategies[request.mode]
        return strategy.execute(request)
```

### 3. çŠ¶æ€æ¨¡å¼
```python
class WorkflowFlowStateManager:
    """çŠ¶æ€æ¨¡å¼ - ç®¡ç†å¤æ‚çš„å·¥ä½œæµçŠ¶æ€è½¬æ¢"""
    def __init__(self):
        self.current_node = WorkflowNode.PHASE_A_COMPLETE
        self.state_handlers = {
            WorkflowNode.PROBLEM_DETECTION: self._handle_problem_detection,
            WorkflowNode.FIX_SUGGESTION: self._handle_fix_suggestion,
            # ... å…¶ä»–çŠ¶æ€å¤„ç†å™¨
        }

    def transition_to(self, target_node: WorkflowNode):
        handler = self.state_handlers[target_node]
        return handler()
```

### 4. å·¥å‚æ¨¡å¼
```python
class LLMProviderFactory:
    """æŠ½è±¡å·¥å‚æ¨¡å¼ - åˆ›å»ºä¸åŒLLMæä¾›å•†"""
    @staticmethod
    def create_provider(provider_name: str) -> LLMProvider:
        if provider_name == "zhipu":
            return ZhipuProvider()
        elif provider_name == "openai":
            return OpenAIProvider()
        elif provider_name == "anthropic":
            return AnthropicProvider()
        else:
            raise ValueError(f"Unsupported provider: {provider_name}")
```

## ğŸ“Š æŠ€æœ¯ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§
- âœ… **å¤šæ¨¡å¼åˆ†æ** - é™æ€ã€æ·±åº¦ã€ä¿®å¤ã€å·¥ä½œæµå››ç§æ¨¡å¼
- âœ… **æ™ºèƒ½æ–‡ä»¶é€‰æ‹©** - AIé©±åŠ¨çš„æ–‡ä»¶é€‰æ‹©ç­–ç•¥
- âœ… **å¤šLLMæ”¯æŒ** - æ™ºè°±AIã€OpenAIã€Anthropicå¤šæä¾›å•†
- âœ… **å®Œæ•´å·¥ä½œæµ** - Bâ†’Câ†’Dâ†’Eâ†’F/Gâ†’Hâ†’Iâ†’J/Kâ†’Lâ†’B/Mé—­ç¯
- âœ… **ç”¨æˆ·åä½œ** - AIå»ºè®® + ç”¨æˆ·å†³ç­–çš„åé¦ˆæœºåˆ¶
- âœ… **å®‰å…¨ä¿æŠ¤** - è‡ªåŠ¨å¤‡ä»½å’Œå›æ»šæœºåˆ¶
- âœ… **åŒç•Œé¢æ”¯æŒ** - CLIå’ŒWebä¸¤ç§äº¤äº’æ–¹å¼

### ğŸ› ï¸ æŠ€æœ¯æ¶æ„ç‰¹æ€§
- âœ… **æ¨¡å—åŒ–è®¾è®¡** - æ¸…æ™°çš„åˆ†å±‚æ¶æ„
- âœ… **å¼‚æ­¥æ”¯æŒ** - æ”¯æŒå¼‚æ­¥å¤„ç†å’Œå¹¶å‘
- âœ… **é…ç½®ç®¡ç†** - çµæ´»çš„é…ç½®ç³»ç»Ÿ
- âœ… **ç¼“å­˜ä¼˜åŒ–** - æ™ºèƒ½ç¼“å­˜æå‡æ€§èƒ½
- âœ… **æ—¥å¿—è¿½è¸ª** - å®Œæ•´çš„æ“ä½œæ—¥å¿—
- âœ… **é”™è¯¯å¤„ç†** - å¥å£®çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- âœ… **æ‰©å±•æ€§** - æ˜“äºæ‰©å±•æ–°çš„åˆ†æå·¥å…·

### ğŸ”§ å¼€å‘ç‰¹æ€§
- âœ… **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ç±»å‹æ³¨è§£
- âœ… **æµ‹è¯•è¦†ç›–** - å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- âœ… **ä»£ç è´¨é‡** - Blackã€Flake8ã€MyPyæ£€æŸ¥
- âœ… **æ–‡æ¡£å®Œå–„** - è¯¦ç»†çš„APIæ–‡æ¡£å’Œç”¨æˆ·æŒ‡å—
- âœ… **CI/CDå°±ç»ª** - æ”¯æŒè‡ªåŠ¨åŒ–æ„å»ºå’Œéƒ¨ç½²

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡
- âš¡ **é™æ€åˆ†æ** - æ¯«ç§’çº§å“åº”
- ğŸ§  **æ·±åº¦åˆ†æ** - ç§’çº§å“åº”ï¼ˆå–å†³äºAIå“åº”æ—¶é—´ï¼‰
- ğŸ”„ **å·¥ä½œæµå¤„ç†** - æ”¯æŒå¤§é¡¹ç›®å’Œå¤æ‚åœºæ™¯
- ğŸ’¾ **å†…å­˜ä½¿ç”¨** - æ™ºèƒ½ç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—
- ğŸŒ **å¹¶å‘å¤„ç†** - æ”¯æŒå¤šæ–‡ä»¶å¹¶è¡Œåˆ†æ

### ğŸ”§ ä¼˜åŒ–ç­–ç•¥
- **æ™ºèƒ½ç¼“å­˜** - åˆ†æç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—
- **å¹¶è¡Œå¤„ç†** - å¤šæ–‡ä»¶å¹¶è¡Œåˆ†ææå‡æ•ˆç‡
- **æµå¼å“åº”** - å¤§æ–‡æœ¬åˆ†å—å¤„ç†
- **æ‡’åŠ è½½** - æŒ‰éœ€åŠ è½½æ¨¡å—å’Œå·¥å…·
- **èµ„æºç®¡ç†** - æ™ºèƒ½å†…å­˜å’Œè¿æ¥ç®¡ç†

## ğŸ“ æ”¯æŒä¸è´¡çŒ®

### ğŸ“– æ–‡æ¡£èµ„æº
- [ğŸš€ å¿«é€Ÿå¼€å§‹](docs/QUICKSTART.md) - 5åˆ†é’Ÿä¸Šæ‰‹æŒ‡å—
- [ğŸ“¦ å®‰è£…æŒ‡å—](docs/Guide/INSTALL_GUIDE.md) - è¯¦ç»†å®‰è£…è¯´æ˜
- [ğŸ”‘ APIé…ç½®](docs/Guide/API_CONFIG_GUIDE.md) - LLMé…ç½®æŒ‡å—

### ğŸ¤ è·å–å¸®åŠ©
```bash
# è¿è¡Œè¯Šæ–­å·¥å…·
python3 scripts/configure_llm.py --diagnose

# æŸ¥çœ‹é…ç½®çŠ¶æ€
python3 scripts/configure_llm.py --status

# æµ‹è¯•APIè¿æ¥
python3 scripts/configure_llm.py --test zhipu
```

### ğŸ› é—®é¢˜åé¦ˆ
- æäº¤IssueæŠ¥å‘Šé—®é¢˜
- æŸ¥çœ‹Wikiè·å–æ›´å¤šä¿¡æ¯
- å‚ä¸ç¤¾åŒºè®¨è®º

### ğŸ”§ è´¡çŒ®æŒ‡å—
æ¬¢è¿æäº¤Pull Requestï¼
- Forké¡¹ç›®
- åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
- æäº¤æ›´æ”¹
- å‘èµ·Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) è®¸å¯è¯ã€‚

---

<div align="center">

**ğŸš€ è®©AIæˆä¸ºæ‚¨çš„ä»£ç è´¨é‡å®ˆæŠ¤è€…ï¼**

[â­ ç»™æˆ‘ä»¬ä¸€ä¸ªStar](https://github.com/3uyuan1ee/Fix_agent) â€¢ [ğŸ› æŠ¥å‘Šé—®é¢˜](https://github.com/3uyuan1ee/Fix_agent/issues) â€¢ [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](docs/)

</div>